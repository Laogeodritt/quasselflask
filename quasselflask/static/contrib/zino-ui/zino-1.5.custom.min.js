(function(b,p){function l(){this._defaults={autocomplete:!1,dataSource:null,multiple:!1};this._events={change:null,close:null,open:null,select:null}}l.prototype={_attachCombobox:function(a,c){if(this._getInst(a))return!1;var k,f,m,g=b(a),h=this,e=h._newInst(g);b.extend(e.settings,h._defaults,h._events,c);g.attr({role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":"zui-combobox-listbox-"+e.uid,"aria-activedescendant":""}).addClass("zui-combobox zui-combobox-combo").wrap('<div class="zui-combobox-wrapper zui-unselectable" />').bind("comboboxopen",
function(b,d){null!==e.settings.open&&e.settings.open.call(a,b,d)}).bind("comboboxselect",function(b,d){null!==e.settings.select&&e.settings.select.call(a,b,d)}).bind("comboboxchange",function(b,d){null!==e.settings.change&&e.settings.change.call(a,b,d)}).bind("comboboxclose",function(b,d){null!==e.settings.close&&e.settings.close.call(a,b,d)});var l=g.width()+26,n=g.parent().offset();m=g.parent();m.css("width",l+"px");k=b("<div>",{id:"zui-combobox-"+e.uid}).hide().css({position:"absolute",top:n.top+
m.height()+1+"px",left:n.left+"px",width:l+"px"});f=b("<ul>",{role:"listbox",id:"zui-combobox-listbox-"+e.uid}).addClass("zui-combobox-list zui-unselectable");e.settings.dataSource.load(function(a){for(var d=0,c=a.length;d<c;d++)"object"===typeof this.opts.fields[0]?b("<li>",{role:"option",id:["zui-combobox-option-",e.uid,"-",d].join("")}).addClass("zui-combobox-item").text(a[d][this.opts.fields[0].name]).appendTo(f):b("<li>",{role:"option",id:["zui-combobox-option-",e.uid,"-",d].join("")}).addClass("zui-combobox-item").text(a[d][this.opts.fields[0]]).appendTo(f)});
b("<span>").addClass("zui-combobox-trigger zui-unselectable").bind("click.combobox",function(){k.is(":visible")?h._closeCombobox.call(h,a):h._openCombobox.call(h,a)}).append("<span />").appendTo(g.parent());f.on("mouseover.combobox",".zui-combobox-item",function(){b(this).addClass("zui-combobox-item-hover")}).on("mouseout.combobox",".zui-combobox-item",function(){b(this).removeClass("zui-combobox-item-hover")}).on("click.combobox",".zui-combobox-item",function(){var c=b(this);if(e.settings.multiple){g.val();
var c=c.text(),d=g.data("stack");if(d===p)g.data("stack",[c]),g.val(c).focus();else{var f=b.inArray(c,d);-1===f?d.push(c):d.splice(f,1);g.data("stack",d).val(d.join(", ")).focus()}}else h._selectCombobox.call(h,a,c.index()),h._closeCombobox.call(h,a)});if(e.settings.autocomplete)m.on("keyup.combobox",g,function(){var c=g.val();0<c.length?b("li",f).show().not("li:contains('"+c+"')").hide():b("li",f).show();k.is(":visible")||h._openCombobox.call(h,a)});f.appendTo(k);k.appendTo(document.body);b(window).off(".combobox").on("mousedown.combobox",
document.body,function(a){var c=b(a.target);c.hasClass("zui-combobox-item")||c.hasClass("zui-combobox-trigger")||c.hasClass("zui-combobox")||c.hasClass("zui-combobox-wrapper")||c.hasClass("zui-combobox-list")||(a.stopPropagation(),b(".zui-combobox").zinoCombobox("close"))});e.list=f;e.container=k;b.data(a,"combobox",e)},_openCombobox:function(a){var c=this._getInst(a);if(!c)return!1;c.container.is(":visible")||(c.container.show(),b(a).attr("aria-expanded","true").trigger("comboboxopen",{}))},_selectCombobox:function(a,
c){var k=this._getInst(a);if(!k)return!1;var f;b.isNumeric(c)?f=b("li",k.list).eq(c):c instanceof jQuery&&(f=c);f.siblings("li").removeClass("zui-combobox-item-selected").end().addClass("zui-combobox-item-selected");b(a).trigger("comboboxselect",{index:c,item:f}).attr("aria-activedescendant",["zui-combobox-option-",k.uid,"-",f.index()].join("")).val(f.text()).focus().trigger("comboboxchange",{index:c,item:f})},_closeCombobox:function(a){var c=this._getInst(a);if(!c)return!1;c.container.is(":visible")&&
(c.container.hide(),b(a).attr("aria-expanded","false").trigger("comboboxclose",{}))},_newInst:function(a){return{id:a[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1"),input:a,uid:Math.floor(99999999*Math.random()),isDisabled:!1,settings:{}}},_getInst:function(a){try{return b.data(a,"combobox")}catch(c){throw"Missing instance data for this combobox";}}};b.fn.zinoCombobox=function(a){var c=Array.prototype.slice.call(arguments,1);return"string"==typeof a&&"isDisabled"==a||"option"==a&&2==arguments.length&&
"string"==typeof arguments[1]?b.zinoCombobox["_"+a+"Combobox"].apply(b.zinoCombobox,[this[0]].concat(c)):this.each(function(){"string"==typeof a?b.zinoCombobox["_"+a+"Combobox"].apply(b.zinoCombobox,[this].concat(c)):b.zinoCombobox._attachCombobox(this,a)})};b.zinoCombobox=new l;b.zinoCombobox.version="1.5"})(jQuery);

(function(l,e){function k(a){if(!(this instanceof k))return new k(a);this._total=this._pages=this._offset=0;this.originalData=[];this._view=[];this.cache=!1;this.callback=null;this.init.call(this,a);return this}function h(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function m(a){var c=1;"-"===a[0]&&(c=-1,a=a.substr(1,a.length-1));return function(b,d){return(b[a]<d[a]?-1:b[a]>d[a]?1:0)*c}}function n(){var a=arguments;return function(c,b){for(var d=0,g=0,f=a.length;0===g&&
d<f;)g=m(a[d])(c,b),d++;return g}}function p(a,c){switch(c.toLowerCase()){case "int":case "integer":case "numeric":return parseInt(a,10);case "bool":case "boolean":if("true"===a.toLowerCase()||"1"===a||1===a)return!0;if("false"===a.toLowerCase()||"0"===a||0===a)return!1;break;case "string":return a.toString();case "float":case "decimal":return parseFloat(a);case "date":return new Date(a)}}var q={autoLoad:!1,data:[],dataType:"array",dataUrl:null,fields:[],page:1,rowCount:20,xmlRoot:null,xmlRecord:null,
filter:null,sort:null,change:null};k.guid=function(){return[h(),h(),"-",h(),"-",h(),"-",h(),"-",h(),h(),h()].join("")};k.prototype={add:function(a){if(a===e)throw Error("Data item is undefined");a._zuid_=k.guid();this.opts.data.push(a);this._total=this.opts.data.length;this._pages=Math.ceil(this._total/this.opts.rowCount);this._offset=(parseInt(this.opts.page,10)-1)*this.opts.rowCount;this.refresh.call(this);return this},cancel:function(){this.opts.data=this.originalData;$(this).trigger("datasourcechange",
{});return this},data:function(){if(0===arguments.length)return this.opts.data;this.opts.data=arguments[0];return this},filter:function(){if(0===arguments.length)return this.opts.filter;this.opts.filter=arguments[0];this._filter.call(this);return this},getById:function(a){for(var c=0,b=this.opts.data.length;c<b;c++)if(this.opts.data[c]._zuid_===a)return this.opts.data[c];return null},getByIndex:function(a){return this.opts.data[a]!==e?this.opts.data[a]:null},init:function(a){var c=this;this.opts=
$.extend(q,a);$(this).bind("datasourcechange",function(a,d){null!==c.opts.change&&c.opts.change.call(this,a,d)});this.opts.autoLoad&&this.load.call(this)},insert:function(a,c){if(c===e)throw Error("Data item is undefined");this.opts.data.splice(a,0,c);this.refresh.call(this);return this},load:function(a){function c(a){for(var b=0,c=a.length;b<c;b++)a[b]._zuid_=k.guid();return a}var b=this;a!==e&&"function"===typeof a&&(b.callback=a);switch(this.opts.dataType){case "json":$.get(this.opts.dataUrl).done(function(d){b._total=
d.length;b._pages=Math.ceil(b._total/b.opts.rowCount);b._offset=(parseInt(b.opts.page,10)-1)*b.opts.rowCount;b.opts.data=c(d);b._sort.call(b);b._view=b.opts.data.slice(b._offset,b._offset+b.opts.rowCount);b.originalData=b.opts.data;a!==e&&"function"===typeof a&&a.call(b,b._view)});break;case "xml":$.get(this.opts.dataUrl).done(function(d){var g=[];$($.parseXML(d)).find(b.opts.xmlRoot).find(b.opts.xmlRecord).each(function(a,c){g.push({});$(c).children().each(function(c,d){c=0;for(var e=b.opts.fields.length;c<
e;c++)if("object"===typeof b.opts.fields[c]){if(this.nodeName===b.opts.fields[c].name){g[a][this.nodeName]=p($(d).text(),b.opts.fields[c].type);break}}else g[a][this.nodeName]=$(d).text()})});b._total=g.length;b._pages=Math.ceil(b._total/b.opts.rowCount);b._offset=(parseInt(b.opts.page,10)-1)*b.opts.rowCount;b.opts.data=g.slice(b._offset,b._offset+b.opts.rowCount);b.opts.data=c(b.opts.data);b.originalData=b.opts.data;b._sort.call(b);a!==e&&"function"===typeof a&&a.call(b,b.opts.data)});break;default:this._total=
this.opts.data.length,this.opts.data=c(this.opts.data),this.originalData=this.opts.data,this._sort.call(this),a!==e&&"function"===typeof a&&a.call(this,this.opts.data)}$(this).trigger("datasourcechange",{});return this},page:function(){if(0===arguments.length)return this.opts.page;this.opts.page=parseInt(arguments[0],10);return this},pages:function(){return this._pages},refresh:function(){this.callback!==e&&null!==this.callback&&"function"===typeof this.callback&&(this._offset=(parseInt(this.opts.page,
10)-1)*this.opts.rowCount,this._view=this.opts.data.slice(this._offset,this._offset+this.opts.rowCount),this._pages=Math.ceil(this._total/this.opts.rowCount),this.callback.call(this,this._view));return this},remove:function(a){if(a===e)throw Error("Data item is undefined");for(var c=0,b=this.opts.data.length;c<b;c++)if(JSON.stringify(a)===JSON.stringify(this.opts.data[c])){this.opts.data.splice(c,1);break}this._total=this.opts.data.length;this._pages=Math.ceil(this._total/this.opts.rowCount);this._offset=
(parseInt(this.opts.page,10)-1)*this.opts.rowCount;this.refresh.call(this);return this},removeById:function(a){for(var c=0,b=this.opts.data.length;c<b;c++)if(this.opts.data[c]._zuid_===a){this.opts.data.splice(c,1);break}this._total=this.opts.data.length;this._pages=Math.ceil(this._total/this.opts.rowCount);this._offset=(parseInt(this.opts.page,10)-1)*this.opts.rowCount;this.refresh.call(this);return this},removeByIndex:function(a){this.opts.data.splice(a,1);this._total=this.opts.data.length;this._pages=
Math.ceil(this._total/this.opts.rowCount);this._offset=(parseInt(this.opts.page,10)-1)*this.opts.rowCount;this.refresh.call(this);return this},rowCount:function(){if(0===arguments.length)return this.opts.rowCount;this.opts.rowCount=parseInt(arguments[0],10);return this},sort:function(){if(0===arguments.length)return this.opts.sort;this.opts.sort=arguments[0];this._sort.call(this);return this},total:function(){return this._total},_filter:function(){var a,c,b,d=this.opts.filter,e=d.length;this.opts.data=
$.grep(this.originalData,function(f){c=[];for(a=0;a<e;a++)switch(c[a]=!1,d[a].operator){case "start":b="^"+d[a].value;null!==f[d[a].field].toString().match(b)&&(c[a]=!0);break;case "end":b=d[a].value+"$";null!==f[d[a].field].toString().match(b)&&(c[a]=!0);break;case "lt":case "<":f[d[a].field]<d[a].value&&(c[a]=!0);break;case "lte":case "le":case "<=":f[d[a].field]<=d[a].value&&(c[a]=!0);break;case "gt":case ">":f[d[a].field]>d[a].value&&(c[a]=!0);break;case "gte":case "ge":case ">=":f[d[a].field]>=
d[a].value&&(c[a]=!0);break;case "ne":case "neq":case "!=":f[d[a].field]!=d[a].value&&(c[a]=!0);break;default:f[d[a].field]==d[a].value&&(c[a]=!0)}return-1===$.inArray(!1,c)?!0:!1})},_sort:function(){var a,c,b=[];if(null===this.opts.sort||0===this.opts.sort.length)return!1;a=0;for(c=this.opts.sort.length;a<c;a++)b.push("ASC"===this.opts.sort[a].direction.toUpperCase()?this.opts.sort[a].field:"-"+this.opts.sort[a].field);this.opts.data.sort(n.apply(null,b))}};l.zino=l.zino||{};l.zino.DataSource=k})(window);
