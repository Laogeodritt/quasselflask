{% extends 'skel_main.html' %}
{% block title %}Manage Users{% endblock %}
{% block content %}
    <section>
        {% from "admin/_qf_macros.html" import user_disable_link, user_action_link %}
        <h2>{%trans%}Manage Users{%endtrans%}</h2>

        <div class="userlist-container">
            {% if users %}
                <div class="links-bar"><a href="{{ url_for('admin_create_user') }}">create user</a></div>
                <table class="userlist">
                    <tr>
                        <th>ID</th>
                        <th>Username</th>
                        <th>Email</th>
                        <th><!-- Actions --></th>
                    </tr>
                    {% for user in users %}
                    <tr class="user{% if call_or_get(user.is_superuser) %} superuser{% endif %}">
                        <td class="uid">{{ user.get_id() }}</td>
                        <td class="username">{{ user.username }}</td>
                        <td class="email">{{ user.email }} {% if user.confirmed_at %}<span title="Confirmed" class="confirmed">✓</span>{% else %}<a class="unconfirmed" title="Unconfirmed (click to force confirmed)" href="{{ url_for('admin_confirm_user', userid=user.get_id()) }}">✗</a>{% endif %}</td>
                        <td class="actions">
                            {% if call_or_get(user.is_active) %}{{ user_disable_link(user) }}{% endif %}
                            {{ user_action_link(url_for('admin_manage_user', userid=user.get_id()), 'edit', 'action-edit') }}
                        </td>
                    </tr>
                    {% endfor %}
                    <!-- TODO: verify CSRF protection - something to change in Flask-User? -->
                    <!-- TODO: current user shouldn't be disablable -->
                </table>
            {% else %}
                <p>No users. How'd you even get here?! (More seriously: Probably a bug, contact your friendly neighbourhood Quasselflask developer to report it.)</p>
            {% endif %}
        </div>
    </section>
{% endblock %}
